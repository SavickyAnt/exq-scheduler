os: linux

language: elixir

env:
  TOXIPROXY_VERSION:2.1.3

elixir:
  - 1.5.2
  - 1.5.3
  - 1.6.0

otp_release:
  - 19.0
  - 20.2

services:
  - redis-server

before_install:
  - uname -a 
  - curl -L https://github.com/Shopify/toxiproxy/releases/download/v2.1.3/toxiproxy_2.1.3_amd64.deb > toxiproxy.deb
  - sudo dpkg -i toxiproxy.deb
  - pwd
  - ls -l

before_script:
  - cd sidekiq && bundle install && cd ..
  - toxiproxy-server &
  - sleep 4
  - toxiproxy-cli create redis -l localhost:26379 -u localhost:6379
  - sleep 1
